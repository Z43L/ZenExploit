#include "plugin_interface.h"
#include "vector.h"
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// Función ficticia que simula una inyección SQL
void sql_injection_attack_function(void* data) {
    Payload* payload = (Payload*)data;
    printf("Ejecutando inyección SQL con payload: %s\n", (char*)payload->data);
    // Simular envío del payload a un objetivo
}

// Registrar el vector y payload para la inyección SQL
void register_sql_injection_vector(void) {
    Vector sql_injection_vector = {
        .name = "SQL Injection",
        .description = "Un exploit de demostración para inyección SQL",
        .vulnerability_type = VULN_TYPE_SQL_INJECTION,
        .exploit_function = sql_injection_attack_function,
        .data = NULL  // Este se configurará más tarde con el payload específico
    };

    register_vector(&sql_injection_vector);
}

// Esta función se llamará cuando se cargue el plugin
void register_plugin_vectors(void) {
    register_sql_injection_vector();
}

t_plugin sql_injection_plugin = {
    .name = "SQL Injection Plugin",
    .register_vectors = register_plugin_vectors,
    .register_payloads = NULL  // No necesitamos registrar payloads globalmente para este ejemplo
};
