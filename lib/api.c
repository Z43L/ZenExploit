#include "../include/api.h"
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

GlobalConfig globalConfig = {0};

void initialize(int argc, char **argv) {
    globalConfig.target_ip = get_parameter(argc, argv, "target_ip");
    globalConfig.target_port = atoi(get_parameter(argc, argv, "target_port"));
    // Otras inicializaciones aquí.
}

void set_target_ip(const char* ip_address) { 
    globalConfig.target_ip = strdup(ip_address);
}

void set_target_port(int port) { 
    globalConfig.target_port = port;
}

char* get_parameter(int argc, char **argv, const char* name) {
    for (int i = 0; i < argc; i++) {
        if (strcmp(argv[i], name) == 0 && (i + 1 < argc)) {
            return argv[i + 1];
        }
    }
    return NULL;
}

exploit_vector_t* create_exploit_payload(int size) {
    exploit_vector_t* payload = malloc(sizeof(exploit_vector_t));
    if (payload != NULL) {
        payload->name = strdup("Example Payload");
        payload->attack_function = NULL; // Deberías asignar una función real aquí.
    }
    return payload;
}

int launch_attack(exploit_vector_t *exploit) {
    if (exploit != NULL && exploit->attack_function != NULL) {
        exploit->attack_function(NULL);
        return 0;
    }
    return -1;
}
